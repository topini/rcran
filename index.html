<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrée Euribe">

<title>clases R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">clases R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrée Euribe </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="diseños-experimentales" class="level1">
<h1>Diseños experimentales</h1>
<section id="dca-diseño-completamente-al-azar" class="level2">
<h2 class="anchored" data-anchor-id="dca-diseño-completamente-al-azar">DCA: diseño completamente al azar</h2>
<p>Dosis de fertilización nitrogenada:</p>
<ul>
<li>0</li>
<li>50</li>
<li>100</li>
<li>150 Rep:5</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar el paquete</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir los niveles de los factores</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>factores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Número de repeticiones</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>replicaciones <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el diseño DCA</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>dca <span class="ot">&lt;-</span> <span class="fu">design.crd</span>(<span class="at">trt =</span> factores, <span class="at">r =</span> replicaciones)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el diseño</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$parameters
$parameters$design
[1] "crd"

$parameters$trt
[1]   0  50 100 150

$parameters$r
[1] 5 5 5 5

$parameters$serie
[1] 2

$parameters$seed
[1] -1630920249

$parameters$kinds
[1] "Super-Duper"

$parameters[[7]]
[1] TRUE


$book
   plots r factores
1    101 1      100
2    102 1       50
3    103 1        0
4    104 2      100
5    105 3      100
6    106 2        0
7    107 1      150
8    108 2      150
9    109 4      100
10   110 3        0
11   111 3      150
12   112 2       50
13   113 3       50
14   114 5      100
15   115 4        0
16   116 5        0
17   117 4      150
18   118 5      150
19   119 4       50
20   120 5       50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Si deseas visualizar el diseño en forma de tabla</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>tabla_diseño <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dca)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_diseño) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Replication"</span>, <span class="st">"Treatment"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabla_diseño)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Replication Treatment NA NA          NA          NA   NA  NA NA  NA
1          crd         0  5  2 -1630920249 Super-Duper TRUE 101  1 100
2          crd        50  5  2 -1630920249 Super-Duper TRUE 102  1  50
3          crd       100  5  2 -1630920249 Super-Duper TRUE 103  1   0
4          crd       150  5  2 -1630920249 Super-Duper TRUE 104  2 100
5          crd         0  5  2 -1630920249 Super-Duper TRUE 105  3 100
6          crd        50  5  2 -1630920249 Super-Duper TRUE 106  2   0
7          crd       100  5  2 -1630920249 Super-Duper TRUE 107  1 150
8          crd       150  5  2 -1630920249 Super-Duper TRUE 108  2 150
9          crd         0  5  2 -1630920249 Super-Duper TRUE 109  4 100
10         crd        50  5  2 -1630920249 Super-Duper TRUE 110  3   0
11         crd       100  5  2 -1630920249 Super-Duper TRUE 111  3 150
12         crd       150  5  2 -1630920249 Super-Duper TRUE 112  2  50
13         crd         0  5  2 -1630920249 Super-Duper TRUE 113  3  50
14         crd        50  5  2 -1630920249 Super-Duper TRUE 114  5 100
15         crd       100  5  2 -1630920249 Super-Duper TRUE 115  4   0
16         crd       150  5  2 -1630920249 Super-Duper TRUE 116  5   0
17         crd         0  5  2 -1630920249 Super-Duper TRUE 117  4 150
18         crd        50  5  2 -1630920249 Super-Duper TRUE 118  5 150
19         crd       100  5  2 -1630920249 Super-Duper TRUE 119  4  50
20         crd       150  5  2 -1630920249 Super-Duper TRUE 120  5  50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aquí puedes añadir tus datos de respuesta</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Suponiendo que tienes un vector 'respuestas' con tus datos</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># respuestas &lt;- c(...)  # Aquí irían tus datos de respuesta</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar los datos de respuesta al diseño</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># dca$data &lt;- respuestas</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar análisis de varianza (ANOVA)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># anova_result &lt;- aov(respuestas ~ as.factor(tratamientos), data=dca)</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(anova_result)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar pruebas de comparación de medias</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># HSD_result &lt;- HSD.test(anova_result, "tratamientos", group=TRUE)</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print(HSD_result)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>##DBCA Factor 1 (dosis de nitrogeno): 0,50,100,150 Factor 2 (variedades de papa): canchan y peruanita Bloques: 5</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>factores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>variedad <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"canchan"</span>,<span class="st">"peruanita"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>trt<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>) <span class="co"># factorial 3x2</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>outdesign <span class="ot">&lt;-</span><span class="fu">design.ab</span>(trt, <span class="at">r=</span><span class="dv">5</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(outdesign)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ parameters:List of 8
  ..$ design : chr "factorial"
  ..$ trt    : chr [1:8] "1 1" "1 2" "2 1" "2 2" ...
  ..$ r      : num 5
  ..$ serie  : num 2
  ..$ seed   : int 1661756095
  ..$ kinds  : chr "Super-Duper"
  ..$        : logi TRUE
  ..$ applied: chr "rcbd"
 $ book      :'data.frame': 40 obs. of  4 variables:
  ..$ plots: num [1:40] 101 102 103 104 105 106 107 108 109 110 ...
  ..$ block: Factor w/ 5 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 2 2 ...
  ..$ A    : chr [1:40] "3" "1" "4" "1" ...
  ..$ B    : chr [1:40] "2" "1" "1" "2" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>book<span class="ot">&lt;-</span>outdesign<span class="sc">$</span>book</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>book</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   plots block A B
1    101     1 3 2
2    102     1 1 1
3    103     1 4 1
4    104     1 1 2
5    105     1 4 2
6    106     1 3 1
7    107     1 2 2
8    108     1 2 1
9    109     2 1 1
10   110     2 4 2
11   111     2 1 2
12   112     2 2 1
13   113     2 3 1
14   114     2 2 2
15   115     2 4 1
16   116     2 3 2
17   117     3 4 2
18   118     3 2 1
19   119     3 3 2
20   120     3 3 1
21   121     3 4 1
22   122     3 1 2
23   123     3 1 1
24   124     3 2 2
25   125     4 3 1
26   126     4 2 1
27   127     4 4 1
28   128     4 3 2
29   129     4 2 2
30   130     4 1 1
31   131     4 1 2
32   132     4 4 2
33   133     5 2 1
34   134     5 2 2
35   135     5 1 2
36   136     5 3 1
37   137     5 1 1
38   138     5 4 1
39   139     5 4 2
40   140     5 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#head(book,30) # print of the field book</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#Analisis de datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(tidyverse)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(googlesheets4)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>fb <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"LA MOLINA 2014 POTATO WUE (FB).xlsx"</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">sheet =</span> <span class="st">"fb"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(fb)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [150 × 18] (S3: tbl_df/tbl/data.frame)
 $ riego  : chr [1:150] "sequia" "sequia" "irrigado" "sequia" ...
 $ geno   : chr [1:150] "G01" "G02" "G01" "G02" ...
 $ block  : num [1:150] 2 4 3 1 2 5 1 4 2 1 ...
 $ bloque : chr [1:150] "II" "IV" "III" "I" ...
 $ spad_29: num [1:150] 56.3 52.7 49.2 55.5 58.2 43.5 57.4 56.1 61 60.3 ...
 $ spad_83: num [1:150] 41.1 47.9 41.6 44.2 32.6 37.8 42.5 35.9 57.5 41.8 ...
 $ rwc_84 : num [1:150] 61.5 63.2 67.7 64.9 74.5 ...
 $ op_84  : num [1:150] -2.43 -3.03 -2.5 -2.4 -2.27 ...
 $ leafdw : num [1:150] 13.28 9.42 18.22 8.84 14.55 ...
 $ stemdw : num [1:150] 14.87 8.63 24.19 6.58 12.63 ...
 $ rootdw : num [1:150] 3.83 2.1 3.16 2 1.83 2.83 2.28 3.65 4.04 4.17 ...
 $ tubdw  : num [1:150] 19.8 17.7 38 13.5 51.1 ...
 $ biomdw : num [1:150] 51.8 37.8 83.6 30.9 80.2 ...
 $ hi     : num [1:150] 0.45 0.43 0.455 0.437 0.638 ...
 $ ttrans : num [1:150] 4.5 3.54 8.39 2.9 7.37 ...
 $ wue    : num [1:150] 11.51 10.69 9.97 10.65 10.88 ...
 $ twue   : num [1:150] 4.4 4.99 4.53 4.65 6.94 ...
 $ lfa    : num [1:150] 2900 2619 7579 2450 5413 ...</code></pre>
</div>
</div>
<p>##Importar datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#url &lt;- "https"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gs &lt;- as_sheets_id(url)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fb &lt;- range_read(gs,"fb")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>##Modelo estadistico</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="at">formula =</span> lfa <span class="sc">~</span> riego <span class="sc">+</span> geno <span class="sc">+</span> riego<span class="sc">*</span>geno <span class="sc">+</span> block, <span class="at">data =</span> fb)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: lfa
            Df    Sum Sq   Mean Sq   F value Pr(&gt;F)    
riego        1 788556926 788556926 1419.9535 &lt;2e-16 ***
geno        14 261729564  18694969   33.6640 &lt;2e-16 ***
block        1   1147402   1147402    2.0661 0.1532    
riego:geno  14 108147972   7724855   13.9101 &lt;2e-16 ***
Residuals  119  66085454    555340                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>##Comparacion de medias</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">duncan.test</span>(modelo, <span class="at">trt=</span><span class="fu">c</span>(<span class="st">"riego"</span>,<span class="st">"geno"</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
   MSerror  Df     Mean       CV
  555339.9 119 4806.708 15.50357

$parameters
    test     name.t ntr alpha
  Duncan riego:geno  30  0.05

$duncan
      Table CriticalRange
2  2.800284      933.2469
3  2.947157      982.1951
4  3.044822     1014.7438
5  3.116483     1038.6260
6  3.172204     1057.1963
7  3.217231     1072.2021
8  3.254626     1084.6647
9  3.286327     1095.2297
10 3.313634     1104.3303
11 3.337458     1112.2701
12 3.358461     1119.2697
13 3.377138     1125.4942
14 3.393868     1131.0699
15 3.408949     1136.0959
16 3.422617     1140.6508
17 3.435061     1144.7982
18 3.446439     1148.5900
19 3.456879     1152.0692
20 3.466489     1155.2720
21 3.475361     1158.2287
22 3.483571     1160.9649
23 3.491189     1163.5037
24 3.498280     1165.8672
25 3.504863     1168.0609
26 3.511012     1170.1104
27 3.516761     1172.0260
28 3.522132     1173.8163
29 3.527185     1175.5002
30 3.531889     1177.0678

$means
                   lfa        std r       se     Min      Max     Q25      Q50
irrigado:G01  7377.892  583.61443 5 333.2686 6539.86  7982.73 7038.08  7578.79
irrigado:G02  5779.562 1127.71742 5 333.2686 4631.00  7392.38 5162.74  5233.55
irrigado:G03  5416.770   89.80871 5 333.2686 5305.77  5545.69 5369.88  5412.51
irrigado:G04  9668.932  945.94448 5 333.2686 8569.08 10811.84 8867.03  9791.10
irrigado:G05  8878.756 1235.57574 5 333.2686 7205.94 10291.06 8189.67  8913.12
irrigado:G06  7455.364 1009.33982 5 333.2686 6576.65  9040.06 6857.13  6938.90
irrigado:G07  1374.156  411.10652 5 333.2686 1065.26  1989.25 1068.97  1140.05
irrigado:G08  7286.826  282.80318 5 333.2686 6998.00  7643.80 7012.74  7310.01
irrigado:G09 10287.712 1548.81007 5 333.2686 8533.54 12296.22 8924.78 10764.71
irrigado:G10  5271.344  822.34789 5 333.2686 4249.18  6164.24 4743.16  5171.21
irrigado:G11  6854.880 1888.72290 5 333.2686 3966.33  8867.09 6210.41  7225.02
irrigado:G12  7417.258  946.24681 5 333.2686 6111.43  8603.78 7164.03  7194.26
irrigado:G13  8672.380 1015.60193 5 333.2686 7180.79  9743.70 8256.98  8750.00
irrigado:G14  8384.132 1473.21710 5 333.2686 6049.52  9776.01 7895.00  8978.89
irrigado:G15  6367.026  107.45072 5 333.2686 6270.00  6522.46 6302.79  6304.88
sequia:G01    3039.588  115.85242 5 333.2686 2900.00  3203.70 2994.58  2999.66
sequia:G02    2717.050  281.05239 5 333.2686 2449.59  3063.35 2487.28  2618.85
sequia:G03    2059.052  179.44660 5 333.2686 1811.97  2274.48 1953.50  2107.76
sequia:G04    2978.712  302.61678 5 333.2686 2511.13  3263.70 2889.83  3010.27
sequia:G05    1783.678  120.66794 5 333.2686 1657.64  1967.49 1700.00  1771.80
sequia:G06    3348.074  165.94367 5 333.2686 3159.54  3550.19 3198.96  3381.68
sequia:G07     680.734  335.90739 5 333.2686  216.31  1097.98  495.83   782.10
sequia:G08    2373.624  260.99914 5 333.2686 2021.37  2697.93 2278.60  2319.71
sequia:G09    3073.322  198.12400 5 333.2686 2781.32  3238.41 2961.78  3150.00
sequia:G10    2924.648  235.40497 5 333.2686 2541.12  3136.07 2909.10  2940.95
sequia:G11    2062.412  317.51100 5 333.2686 1556.38  2301.31 1942.23  2237.88
sequia:G12    2446.404   37.06811 5 333.2686 2400.00  2487.78 2425.26  2438.98
sequia:G13    3126.100   47.70803 5 333.2686 3062.34  3191.97 3110.00  3120.00
sequia:G14    3514.338  217.30731 5 333.2686 3318.36  3811.99 3326.93  3449.76
sequia:G15    1580.506  248.79682 5 333.2686 1176.63  1814.84 1560.00  1601.06
                  Q75
irrigado:G01  7750.00
irrigado:G02  6478.14
irrigado:G03  5450.00
irrigado:G04 10305.61
irrigado:G05  9793.99
irrigado:G06  7864.08
irrigado:G07  1607.25
irrigado:G08  7469.58
irrigado:G09 10919.31
irrigado:G10  6028.93
irrigado:G11  8005.55
irrigado:G12  8012.79
irrigado:G13  9430.43
irrigado:G14  9221.24
irrigado:G15  6435.00
sequia:G01    3100.00
sequia:G02    2966.18
sequia:G03    2147.55
sequia:G04    3218.63
sequia:G05    1821.46
sequia:G06    3450.00
sequia:G07     811.45
sequia:G08    2550.51
sequia:G09    3235.10
sequia:G10    3096.00
sequia:G11    2274.26
sequia:G12    2480.00
sequia:G13    3146.19
sequia:G14    3664.65
sequia:G15    1750.00

$comparison
NULL

$groups
                   lfa groups
irrigado:G09 10287.712      a
irrigado:G04  9668.932     ab
irrigado:G05  8878.756     bc
irrigado:G13  8672.380      c
irrigado:G14  8384.132     cd
irrigado:G06  7455.364     de
irrigado:G12  7417.258     de
irrigado:G01  7377.892    def
irrigado:G08  7286.826     ef
irrigado:G11  6854.880     ef
irrigado:G15  6367.026     fg
irrigado:G02  5779.562     gh
irrigado:G03  5416.770     gh
irrigado:G10  5271.344      h
sequia:G14    3514.338      i
sequia:G06    3348.074     ij
sequia:G13    3126.100    ijk
sequia:G09    3073.322    ijk
sequia:G01    3039.588    ijk
sequia:G04    2978.712    ijk
sequia:G10    2924.648    ijk
sequia:G02    2717.050   ijkl
sequia:G12    2446.404  ijklm
sequia:G08    2373.624  jklmn
sequia:G11    2062.412   klmn
sequia:G03    2059.052   klmn
sequia:G05    1783.678    lmn
sequia:G15    1580.506    mno
irrigado:G07  1374.156     no
sequia:G07     680.734      o

attr(,"class")
[1] "group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 6
 $ statistics:'data.frame': 1 obs. of  4 variables:
  ..$ MSerror: num 555340
  ..$ Df     : int 119
  ..$ Mean   : num 4807
  ..$ CV     : num 15.5
 $ parameters:'data.frame': 1 obs. of  4 variables:
  ..$ test  : chr "Duncan"
  ..$ name.t: chr "riego:geno"
  ..$ ntr   : int 30
  ..$ alpha : num 0.05
 $ duncan    :'data.frame': 29 obs. of  2 variables:
  ..$ Table        : num [1:29] 2.8 2.95 3.04 3.12 3.17 ...
  ..$ CriticalRange: num [1:29] 933 982 1015 1039 1057 ...
 $ means     :'data.frame': 30 obs. of  9 variables:
  ..$ lfa: num [1:30] 7378 5780 5417 9669 8879 ...
  ..$ std: num [1:30] 583.6 1127.7 89.8 945.9 1235.6 ...
  ..$ r  : int [1:30] 5 5 5 5 5 5 5 5 5 5 ...
  ..$ se : num [1:30] 333 333 333 333 333 ...
  ..$ Min: num [1:30] 6540 4631 5306 8569 7206 ...
  ..$ Max: num [1:30] 7983 7392 5546 10812 10291 ...
  ..$ Q25: num [1:30] 7038 5163 5370 8867 8190 ...
  ..$ Q50: num [1:30] 7579 5234 5413 9791 8913 ...
  ..$ Q75: num [1:30] 7750 6478 5450 10306 9794 ...
 $ comparison: NULL
 $ groups    :'data.frame': 30 obs. of  2 variables:
  ..$ lfa   : num [1:30] 10288 9669 8879 8672 8384 ...
  ..$ groups: chr [1:30] "a" "ab" "bc" "c" ...
 - attr(*, "class")= chr "group"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(mc)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to emmeans.
Caution: You lose important information if you filter this package's results.
See '? untidy'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: TH.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'TH.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, <span class="sc">~</span>riego <span class="sc">|</span> geno) <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letter =</span> letters, <span class="at">reversed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>geno = G01:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   7378 333 119   6718.0     8038  a    
 sequia     3040 333 119   2379.7     3699   b   

geno = G02:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   5780 333 119   5119.7     6439  a    
 sequia     2717 333 119   2057.1     3377   b   

geno = G03:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   5417 333 119   4756.9     6077  a    
 sequia     2059 333 119   1399.1     2719   b   

geno = G04:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   9669 333 119   9009.0    10329  a    
 sequia     2979 333 119   2318.8     3639   b   

geno = G05:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   8879 333 119   8218.9     9539  a    
 sequia     1784 333 119   1123.8     2444   b   

geno = G06:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   7455 333 119   6795.5     8115  a    
 sequia     3348 333 119   2688.2     4008   b   

geno = G07:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   1374 333 119    714.3     2034  a    
 sequia      681 333 119     20.8     1341  a    

geno = G08:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   7287 333 119   6626.9     7947  a    
 sequia     2374 333 119   1713.7     3034   b   

geno = G09:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado  10288 333 119   9627.8    10948  a    
 sequia     3073 333 119   2413.4     3733   b   

geno = G10:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   5271 333 119   4611.4     5931  a    
 sequia     2925 333 119   2264.7     3585   b   

geno = G11:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   6855 333 119   6195.0     7515  a    
 sequia     2062 333 119   1402.5     2722   b   

geno = G12:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   7417 333 119   6757.4     8077  a    
 sequia     2446 333 119   1786.5     3106   b   

geno = G13:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   8672 333 119   8012.5     9332  a    
 sequia     3126 333 119   2466.2     3786   b   

geno = G14:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   8384 333 119   7724.2     9044  a    
 sequia     3514 333 119   2854.4     4174   b   

geno = G15:
 riego    emmean  SE  df lower.CL upper.CL .group
 irrigado   6367 333 119   5707.1     7027  a    
 sequia     1581 333 119    920.6     2240   b   

Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>##Grafico</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(inti)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: shiny</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tidyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tibble</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_smr</span>(<span class="at">data =</span> mc, <span class="at">type =</span> <span class="st">"bar"</span>, <span class="at">x =</span> <span class="st">"geno"</span>, <span class="at">y =</span> <span class="st">"emmean"</span>, <span class="at">group =</span> <span class="st">"riego"</span>, <span class="at">sig =</span> <span class="st">".group"</span>, <span class="at">error =</span> <span class="st">"SE"</span>, <span class="at">ylimits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12000</span>, <span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">##ggplot(mc, aes(x = geno, y = emmean, fill = riego)) + geom_bar(stat = "identity") + theme_minimal() + labs(title = "Grafico de barras", x = "Categoria", y = "valores")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>